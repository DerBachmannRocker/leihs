:ruby
  opened_menu = if %w{requests templates}.include? controller.controller_name
      if @user and @user == current_user
        :request
      else
        :inspect
      end
    else
    :admin
  end

%ul.sidebar-nav#leftMenu{style: 'margin-top: 1em'}
  - if is_procurement_admin?
    %li
      %a{"data-parent" => "#leftMenu", "data-toggle" => "collapse", :href => "#collapse_admin"}
        %i.fa.fa-gear
        = _('Admin')
      %ul#collapse_admin.collapse{class: opened_menu == :admin ? 'in' : nil}
        %li
          %a{href: budget_periods_path, class: request.path == budget_periods_path ? "active" : nil}
            %i.fa.fa-calendar
            = _('Budget periods')
            - unless Procurement::BudgetPeriod.current
              %i.fa.fa-warning.text-danger
        %li
          %a{href: organizations_path, class: request.path == organizations_path ? "active" : nil}
            %i.fa.fa-sitemap
            = _('Organizations')
            - unless Procurement::Organization.exists?
              %i.fa.fa-warning.text-danger
        %li
          %a{href: groups_path, class: request.path == groups_path ? "active" : nil}
            %i.fa.fa-object-group
            = _('Groups')
            - unless Procurement::Group.exists?
              %i.fa.fa-warning.text-danger
        %li
          %a{href: users_path, class: request.path == users_path ? "active" : nil}
            %i.fa.fa-user
            = _('Users')
            - if Procurement::Access.admins.empty? or Procurement::Access.requesters.empty?
              %i.fa.fa-warning.text-danger

  - if is_procurement_requester?
    %li
      %a{"data-parent" => "#leftMenu", "data-toggle" => "collapse", :href => "#collapse_request"}
        %i.fa.fa-edit
        = _('Requests')
      %ul#collapse_request.collapse{class: opened_menu == :request ? 'in' : nil}
        %li
          %a{href: overview_user_requests_path(current_user), class: opened_menu == :request ? "active" : nil}
            %i.fa.fa-tasks
            = _('My requests')
            =#FIXME :in_inspection# render partial: 'layouts/procurement/counts', locals: {user: current_user}

  - if Procurement::Group.inspector_of_any_group?(current_user)
    %li
      %a{"data-parent" => "#leftMenu", "data-toggle" => "collapse", :href => "#collapse_inspect"}
        %i.fa.fa-eye
        = _('Inspect')
      %ul#collapse_inspect.collapse{class: opened_menu == :inspect ? 'in' : nil}
        %li
          %a{href: filter_overview_requests_path, class: controller.action_name == 'filter_overview' ? "active" : nil}
            %i.fa.fa-eye
            = _('Overview')
        - Procurement::Group.all.partition{|group| group.inspectable_by?(current_user)}.flatten.each do |group|
          %li
            %a{href: overview_group_requests_path(group), class: "#{@group == group ? "active" : nil}"}
              %i.fa.fa-object-group
              = group
              = render partial: 'layouts/procurement/counts', locals: {group: group}
